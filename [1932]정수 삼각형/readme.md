처음에 DFS로 접근했다가 메모리 초과가 발생해서 DP로 접근